FROM debian:bullseye-slim

# Install common dependencies
RUN apt-get update && apt-get install -y \
    curl \
    unzip \
    wget \
    git \
    && rm -rf /var/lib/apt/lists/*

# Install Node.js 20.x
RUN curl -fsSL https://deb.nodesource.com/setup_20.x | bash - \
    && apt-get install -y nodejs \
    && node --version \
    && npm --version

# Install Deno
RUN curl -fsSL https://deno.land/install.sh | DENO_INSTALL=/usr/local sh \
    && ln -s /usr/local/bin/deno /usr/bin/deno

# Install Bun
RUN curl -fsSL https://bun.sh/install | bash \
    && ln -s /root/.bun/bin/bun /usr/local/bin/bun

# Add all runtimes to PATH
ENV PATH="/usr/local/bin:/root/.bun/bin:/usr/bin:${PATH}"

# Verify installations
CMD echo "Node.js: $(node --version)" && \
    echo "npm: $(npm --version)" && \
    echo "Deno: $(deno --version | head -n 1)" && \
    echo "Bun: $(bun --version)"
